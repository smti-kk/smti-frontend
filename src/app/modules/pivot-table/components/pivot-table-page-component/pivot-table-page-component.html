<!--suppress HtmlFormInputWithoutLabel, HtmlUnknownTag -->
<main class="main">
  <div class="wrapper">
    <h1>Сводная таблица по населенным пунктам</h1>
    <div class="c-filter">
      <div class="c-accordion">
        <div (click)="isOpenedAccordion = !isOpenedAccordion" class="c-accordion-title">
          <div class="c-filter-icon">Фильтры</div>
          <div class="d-flex">
            <div [class.search-block]="displayBlockSearch" [class.search-absolute]="!displayBlockSearch">
              <div (click)="isOpenedAccordion = !isOpenedAccordion" [formGroup]="filterForm" class="search-location search-location-pivots">
                <input (focusout)="onSearchInputFocusOut()"
                       (keyup)="onSearchControlKeyPress($event)"
                       [formControl]="searchControl"
                       class="background-transparent"
                       id="searchControl"
                       placeholder="Поиск по населенным пунктам"
                       type="text"
                >
                <input value="" type="submit">
              </div>
            </div>
            <div class="c-accordion-button" [class.is-open]="isOpenedAccordion"></div>
          </div>
        </div>
        <div class="c-accordion-body" *ngIf="isOpenedAccordion" style="display: block">
          <form *ngIf="filterForm" [formGroup]="filterForm">
            <div class="l-container">
              <div class="l-container-item js-filter-button">
                <app-filter-btn formControlName="order" [orderings]="[
                      {name: 'Нас.пункт', value: 'name', orderingDirection: OrderingDirection.UNDEFINED },
                      {name: 'Район', value: 'parent', orderingDirection: OrderingDirection.UNDEFINED },
                      {name: 'Численность', value: 'people_count', orderingDirection: OrderingDirection.UNDEFINED }
                  ]"
                >

                </app-filter-btn>
              </div>
              <div class="l-container-item">
                <div class="c-checkbox" style="opacity: 0.7">
                  <label>
                    <input type="checkbox" [disabled]="true">
                    <div class="c-checkbox-text">Наличие ЕСПД</div>
                  </label>
                </div>
                <div class="c-checkbox">
                  <label> <input type="checkbox" formControlName="hasPayphone">
                    <div class="c-checkbox-text">Наличие таксофона</div>
                  </label>
                </div>
                <div class="c-checkbox">
                  <label> <input formControlName="hasInfomat" type="checkbox">
                    <div class="c-checkbox-text">Наличие инфомата</div>
                  </label>
                </div>
                <div class="c-checkbox">
                  <label> <input type="checkbox" formControlName="hasRadio">
                    <div class="c-checkbox-text">Наличие радио</div>
                  </label>
                </div>
                <div class="c-checkbox">
                  <label> <input type="checkbox" formControlName="hasTelephone">
                    <div class="c-checkbox-text">Наличие телефона</div>
                  </label>
                </div>
              </div>
              <div class="l-container-item">
                <div class="l-container-block is-disabled">
                  <div class="o-item-title">Почта:</div>
                  <div class="c-radiobox">
                    <label>
                      <input formControlName="mailType" type="radio" [value]="MailType.UPC">
                      <div class="c-radiobox-text">УПС</div>
                    </label>
                    <label>
                      <input formControlName="mailType" type="radio" [value]="MailType.MAIL_CONNECTION">
                      <div class="c-radiobox-text">Почтовая связь</div>
                    </label>
                  </div>
                </div>
                <div class="l-container-block is-disabled">
                  <div class="o-item-title">ТВ:</div>
                  <div class="c-radiobox">
                    <label>
                      <input formControlName="tvType" type="radio" [value]="SignalType.ATV">
                      <div class="c-radiobox-text">Аналоговое</div>
                    </label>
                    <label>
                      <input formControlName="tvType" type="radio" [value]="SignalType.CTV">
                      <div class="c-radiobox-text">Цифровое</div>
                    </label>
                  </div>
                </div>
              </div>
              <div class="l-container-item">
                <div class="l-container-row is-disabled">
                  <div class="o-item-title">Сотовая связь:</div>
                  <div class="l-vendors-row u-border-right">
                    <div formGroupName="mobile" class="c-vendor"
                         *ngFor="let mobileProvider of mobileProviders; let i = index">
                      <label [formGroupName]="i.toString()">
                        <input [formControlName]="mobileProvider.id.toString()" type="checkbox">
                        <div class="c-vendor-logo c-vendor-checked">
                          <img [src]="mobileProvider.icon" [alt]="mobileProvider.name" [title]="mobileProvider.name">
                        </div>
                      </label>
                    </div>
                  </div>
                  <div class="c-radiobox l-radiobox-row">
                    <label>
                      <input formControlName="mobileType" [value]="MobileGenerationType.M2G" type="radio">
                      <div class="c-radiobox-text">2G</div>
                    </label>
                    <label>
                      <input formControlName="mobileType" [value]="MobileGenerationType.M3G" type="radio">
                      <div class="c-radiobox-text">3G</div>
                    </label>
                    <label>
                      <input formControlName="mobileType" [value]="MobileGenerationType.M4G" type="radio">
                      <div class="c-radiobox-text">4G</div>
                    </label>
                    <label>
                      <input formControlName="mobileType" [value]="MobileGenerationType.M5G" type="radio">
                      <div class="c-radiobox-text">5G</div>
                    </label>
                  </div>
                </div>
                <div class="l-container-row is-disabled">
                  <div class="o-item-title">Интернет:</div>
                  <div class="l-vendors-column u-border-right">
                    <div formGroupName="internet" class="c-vendor"
                         *ngFor="let internetProvider of internetProviders; let i = index">
                      <label [formGroupName]="i.toString()">
                        <input type="checkbox" [formControlName]="internetProvider.id.toString()">
                        <div class="c-vendor-logo c-vendor-checked">
                          <img [src]="internetProvider.icon" [alt]="internetProvider.name"
                               [title]="internetProvider.name">
                        </div>
                      </label>
                    </div>
                  </div>
                  <div class="c-radiobox l-radiobox-column">
                    <label><input formControlName="internetType" type="radio" [value]="TrunkChannelType.SATELLITE">
                      <div class="c-radiobox-text">Спутник</div>
                    </label>
                    <label><input formControlName="internetType" type="radio" [value]="TrunkChannelType.VOLS">
                      <div class="c-radiobox-text">ВОЛС</div>
                    </label>
                    <label><input formControlName="internetType" type="radio" [value]="TrunkChannelType.COPPER_CABLE">
                      <div class="c-radiobox-text">Медь</div>
                    </label>
                    <label><input formControlName="internetType" type="radio" [value]="TrunkChannelType.RADIO_CHANEl">
                      <div class="c-radiobox-text">Радиоканал</div>
                    </label>
                  </div>
                </div>
                <div class="l-container-row is-disabled">
                  <div class="o-item-title">Программа:</div>
                  <select formControlName="program">
                    <option [value]="null" disabled selected style="display:none;">Выберите программу</option>
                    <option *ngFor="let gv of govPrograms" [ngValue]="gv">{{gv.shortName}}</option>
                  </select>
                </div>
              </div>
            </div>
            .
            <input (click)="filterForm.reset()" class="btn filter-btn-reset" value="Сбросить фильтр" type="button">
          </form>
        </div>
      </div>
      <div class="c-filter-info">
        <div class="c-filter-result">
          Результатов поиска: <span>{{locationFeatures?.length}}</span>
        </div>
        <div class="c-filter-export">
          <input (click)="tcPivots.exportExcel()" type="button" class="btn" value="Выгрузить в Excel">
        </div>
      </div>
    </div>
    <div class="l-table u-table-header l-table-location">
      <div class="l-table-column">№</div>
      <div class="l-table-column">Населенный пункт<br>Район<br>Численность чел.</div>
      <div class="l-table-column">ЕСПД</div>
      <div class="l-table-column">Телефон,<br>Таксофон,<br>Инфомат,<br>Почта</div>
      <div class="l-table-column">ТВ,<br>Радио</div>
      <div class="l-table-column">Связь<br>(сотовая, интернет)</div>
      <div class="l-table-column">Программа</div>
    </div>
    <ngx-spinner
      bdOpacity=0.9
      size="medium"
      color="#35a584"
      type="ball-atom"
      class="spinner"
      [fullScreen]="true"
    >Загрузка. . . (среднее время ожидания: 40 сек.)</ngx-spinner>
    <div class="l-table l-table-location" [id]="lc.id"
         *ngFor="let lc of locationFeatures | paginate: {itemsPerPage: itemsPerPage, currentPage: pageNumber}; let i = index">
      <div class="l-table-column">{{lc.id}}</div>
      <div class="l-table-column">
        <div class="c-location-name">
          <div class="c-location-name-item1" [class.searched-item]="searchedTc === lc">{{lc.name}}</div>
          <div class="c-location-name-item2">{{lc.area}}</div>
        </div>
        <div class="c-location-peoples"><span>{{lc.information.population}}</span> чел.</div>
        <a [routerLink]="[lc.id]" class="btn">Подробнее</a>
      </div>
      <div class="l-table-column">
        <div class="espd true"></div>
      </div>
      <div class="l-table-column">
        <div class="l-table-row">
          <div class="l-table-item"><i class="fas fa-phone-alt"></i></div>
          <div class="l-table-item">
            <div class="c-vendor"
                 *ngFor="let phone of lc.information.telephone"
            >
              <div class="c-vendor-logo"
                   [ngClass]="{ opacity: !phone.provider.isActive }"
              >
                <img class="image"
                     [src]="phone.provider.icon"
                     [alt]="phone.provider.name"
                     [title]="phone.provider.name">
              </div>
            </div>
          </div>
        </div>
        <div class="l-table-row">
          <div class="l-table-item"><i class="fas fa-tty"></i></div>
          <div class="l-table-item">
            <div class="c-vendor" *ngFor="let payphone of lc.information.payphone">
              <div class="c-vendor-logo" [ngClass]="{ opacity: !payphone.provider.isActive || payphone.count === 0 }">
                <img
                  class="image"
                  [src]="payphone.provider.icon"
                  [alt]="payphone.provider.name"
                  [title]="payphone.provider.name"
                >
              </div>
              <div class="vendor-status-text status-pos" *ngIf="payphone.count !== 0">{{payphone.count}}</div>
            </div>
          </div>
        </div>
        <div class="l-table-row">
          <div class="l-table-item"><i class="fas fa-tablet-alt"></i></div>
          <div class="l-table-item u-true"
               *ngIf="lc.information.informat === true">
          </div>
          <div class="l-table-item"
               *ngIf="lc.information.informat === false">
            0
          </div>
        </div>
        <div class="l-table-row">
          <div class="l-table-item"><i class="far fa-envelope"></i></div>
          <div class="l-table-item u-true"
               *ngIf="lc.information.mail.length > 0">
          </div>
          <div class="l-table-item"
               *ngIf="lc.information.mail.length === 0">
            0
          </div>
          <div class="l-table-item" *ngFor="let mail of lc.information.mail">УПС</div>
        </div>
      </div>
      <div class="l-table-column">
        <div class="l-table-row">
          <div class="l-table-item"><i class="fas fa-tv"></i></div>
          <div class="l-table-item">
            <div class="c-vendor" *ngFor="let tv of lc.information.tv">
              <div class="c-vendor-logo" [ngClass]="{opacity: !tv.provider.isActive}">
                <img class="image" [src]="tv.provider.icon" [alt]="tv.provider.name" [title]="tv.provider.name">
              </div>
              <div class="c-vendor-status-text">{{getTvTypeString(tv.type)}}</div>
            </div>
          </div>
        </div>
        <div class="l-table-row">
          <div class="l-table-item"><i class="fas fa-microphone"></i></div>
          <div class="l-table-item">
            <div class="c-vendor" *ngFor="let radio of lc.information.radio">
              <div class="c-vendor-logo" [ngClass]="{ opacity: !radio.provider.isActive }">
                <img class="image"
                     [src]="radio.provider.icon"
                     [alt]="radio.provider.name"
                     [title]="radio.provider.name">
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="l-table-column">
        <div class="l-table-row l-column">
          <div class="o-item-title"><i class="fas fa-mobile-alt"></i> Сотовая связь:</div>
          <div class="l-vendors-row">
            <div class="c-vendor" *ngFor="let phone of lc.information.cellular">
              <div class="c-vendor-logo" [ngClass]="{opacity: !phone.provider.isActive}">
                <img class="image" [src]="phone.provider.icon" [alt]="phone.provider.name"
                     [title]="phone.provider.name">
              </div>
              <div class="c-vendor-status-text">{{phone.mobileGeneration?.name}}</div>
            </div>
          </div>
        </div>
        <div class="l-table-row l-column">
          <div class="o-item-title"><i class="fab fa-internet-explorer"></i> Интернет:</div>
          <div class="l-vendors-row">
            <div class="c-vendor"
                 *ngFor="let internet of lc.information.internet"
            >
              <div class="c-vendor-logo"
                   [ngClass]="{ opacity: !internet.provider.isActive }"
              >
                <img class="image" [src]="internet.provider.icon"
                     [alt]="internet.provider.name"
                     [title]="internet.provider.name">
              </div>
              <div class="c-vendor-status-img"
                   *ngIf="internet.channel"
                   [title]="internet.channel.name"
                   [ngClass]="
                     {
                      vols: internet.channel.id === TrunkChannelType.VOLS,
                      med: internet.channel.id === TrunkChannelType.COPPER_CABLE,
                      radio: internet.channel.id === TrunkChannelType.RADIO_CHANEl,
                      sputnik: internet.channel.id === TrunkChannelType.SATELLITE
                     }"
              ></div>
            </div>
          </div>
        </div>
      </div>
      <div class="l-table-column">
        <div class="l-table-row" *ngFor="let govProgram of lc.govPrograms">
          {{govProgram.shortName}}
        </div>
        <div *ngIf="lc.govPrograms.length === 0" class="l-table-row">
          Нет программы
        </div>
      </div>
    </div>
    <div style="display: flex; justify-content: flex-end" *ngIf="locationFeatures">
      <div class="pagination-count">
        <div style="margin-right: 13px">Количество строк на странице:</div>
        <input class="pagination-count-button" [class.active]="itemsPerPage === 10" type="button"
               (click)="itemsPerPage = 10" value="10">
        <input class="pagination-count-button" [class.active]="itemsPerPage === 20" type="button"
               (click)="itemsPerPage = 20" value="20">
        <input class="pagination-count-button" [class.active]="itemsPerPage === 100" type="button"
               (click)="itemsPerPage = 100" value="100">
      </div>
    </div>
    <pagination-controls
      *ngIf="this.locationFeatures"
      class="pagination-controls"
      (pageChange)="pageNumber = $event"
      previousLabel="Предыдущая страница"
      nextLabel="Следующая страница"
    >

    </pagination-controls>
  </div>
</main>

